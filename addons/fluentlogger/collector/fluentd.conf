<source>
  @type forward
  port 24224
  bind 0.0.0.0
</source>

<filter kube.**>
  @type record_transformer
  enable_ruby
  renew_record
  <record>
    cluster   ${ENV['CLUSTER_NAME']}
    pod       ${record['kubernetes']['pod_name']}
    container ${record['kubernetes']['container_name']}
    namespace ${record['kubernetes']['namespace_name']}
    message   ${record['log']}
  </record>
</filter>

<filter kube.**>
  @type record_transformer
  remove_keys tag
</filter>

# Cloudwatch logs plugin.
# <match k8s.**>
#   @type cloudwatch_logs
#   log_group_name     "#{ENV['CLUSTER_NAME']}"
#   auto_create_stream true
#   use_tag_as_stream  true
# </match>

<match **>
  @type stdout
</match>
